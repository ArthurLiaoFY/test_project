# 組裝產線強化學習系統 (進行中)

本專案針對一個組裝產線的部分系統，應用強化學習（Reinforcement Learning）來優化其運作流程。


## 系統假設
該系統假設
1. 若傳輸帶超過速度則貨物會因為慣性而移動。
2. 手臂為定速運行，前後傳輸帶可控制。

## 系統更新率
3. Agent進行逐秒控制
4. 傳輸帶與機械手臂更新率0.033秒

## 系統簡介

該系統包含以下組件：
- 前方輸送帶：負責將待組裝產品送至前方產品緩存區。
- 產品緩存區（前方）：作為手臂與輸送帶間的連結點，方便藉此定義輸送帶與手臂是否該等待。
- 機械手臂：負責抓取產品，然後將產品移至後方貨物緩存區。
- 產品緩存區（後方）：作為手臂與輸送帶間的連結點，方便藉此定義輸送帶與手臂是否該等待。
- 後方輸送帶：負責將產品送至產品接收器。
- 產品接收器：負責產品接收。

### 運作流程
1. 若前方輸送帶有空閒，且前方緩存區有空間（一單位的空間），則運輸產品至前方緩存區，否則等待。
2. 產品送至前方緩存區後，若手臂空閒則抓取，否則等待。
3. 機械手臂抓取產品並送至後方緩存區（一單位的空間），若後方緩存區有產品堆積，則手臂於終點等待後方緩存區有空間後才能抓取前方緩存區的產品。
4. 若後方輸送帶有空閒，則輸送產品至終點，終點容量假設無上限。

## 目標
1. 盡可能減少輸送機運轉的時間(更少的機械耗損)
2. 適當的運輸速度(貨物不會因為慣性而飛出輸送帶掉落)
3. 最小化手臂等待的時間(更高效率的組裝跟出貨)
4. 最大化每小時出貨量

此處因為假設了手臂為定速運行，所以最小化手臂等待的時間與最大化每小時出貨量等價。

## 強化學習設計

### 1. 狀態空間 (State Space)
系統的狀態由以下變數組成：
- **運送機狀態**
  - 運送機的位置（起點、終點、運送中等）
  - 是否有待運輸的產品
  - 運送機當前速度
- **機械手臂狀態**
  - 是否正在執行動作（抓取、裝配、移動）
  - 是否處於空閒或等待狀態
- **產品狀態**
  - 是否已完成組裝
  - 產品當前所在位置
- **時間相關變數**
  - 運送機運行時間
  - 機械手臂等待時間

### 2. 行動空間 (Action Space)
- **運送機操作**
  - 控制運送機的運行速度（快、慢、停止）
  - 啟動或停止運送機
- **機械手臂操作**
  - 執行抓取、裝配、移動操作
  - 調整機械手臂的動作速度

### 3. 獎勵函數 (Reward Function)
為了達成最佳目標，設計以下回饋函數：

- **出貨獎勵**：每成功出貨一件產品，給予正向獎勵。
- **運送機運行時間懲罰**：減少運送機運轉時間以降低機械損耗。
- **機械手臂等待時間懲罰**：降低機械手臂的空閒時間，提高效率。
- **速度控制懲罰**：若運送機速度過快或過慢，則給予懲罰以確保穩定性。

回饋函數範例：
```
Reward = w1 * 出貨數量 - w2 * 運送機運行時間 - w3 * 機械手臂等待時間 - w4 * 不當速度懲罰
```
其中 `w1, w2, w3, w4` 為權重，可根據需求調整。

## 安裝與執行
1. **安裝依賴項目**
   ```bash
   pip install -r requirements.txt
   ```
2. **執行**
   ```bash
   python main.py
   ```
